<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SalesMind - AI営業思考トレーナー</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="SalesMindは、AIを活用したSPINメソッドベースの営業トレーニングアプリです。実践的な商談シミュレーションで営業スキルを向上させましょう。">
    <meta name="keywords" content="営業トレーニング,SPIN法,AI営業,商談練習,営業スキル向上,セールストレーニング,営業スキル,商談スキル,営業教育">
    <meta name="author" content="SalesMind">
    <meta name="robots" content="index, follow">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://salesmind.mind-bridge.tech/">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://salesmind.mind-bridge.tech/">
    <meta property="og:title" content="SalesMind - AI営業思考トレーナー">
    <meta property="og:description" content="AIを活用したSPINメソッドベースの営業トレーニングアプリ。実践的な商談シミュレーションで営業スキルを向上させましょう。">
    <meta property="og:image" content="https://salesmind.mind-bridge.tech/images/logo_big.PNG">
    <meta property="og:site_name" content="SalesMind">
    <meta property="og:locale" content="ja_JP">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://salesmind.mind-bridge.tech/">
    <meta name="twitter:title" content="SalesMind - AI営業思考トレーナー">
    <meta name="twitter:description" content="AIを活用したSPINメソッドベースの営業トレーニングアプリ。実践的な商談シミュレーションで営業スキルを向上させましょう。">
    <meta name="twitter:image" content="https://salesmind.mind-bridge.tech/images/logo_big.PNG">
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "SalesMind",
      "alternateName": "SalesMind - AI営業思考トレーナー",
      "description": "AIを活用したSPINメソッドベースの営業トレーニングアプリケーション。実践的な商談シミュレーションで営業スキルを向上させることができます。",
      "url": "https://salesmind.mind-bridge.tech/",
      "applicationCategory": ["BusinessApplication", "EducationalApplication"],
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "JPY"
      },
      "featureList": [
        "SPINメソッドに基づく質問生成",
        "AI顧客との対話トレーニング",
        "商談スキル評価とフィードバック",
        "簡易診断モードと詳細診断モード",
        "ランキング機能",
        "音声入力対応"
      ],
      "screenshot": "https://salesmind.mind-bridge.tech/images/logo_big.PNG",
      "softwareVersion": "1.0",
      "releaseNotes": "SPINメソッドベースの営業トレーニングアプリケーション",
      "inLanguage": "ja"
    }
    </script>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- ヘッダー -->
        <header class="header">
            <h1>🧠 SalesMind</h1>
            <p class="subtitle">AI営業思考トレーナー - SPINメソッドで商談スキルを向上</p>
            <div class="auth-section">
                <div id="loginForm" class="auth-form">
                    <h3>ログイン</h3>
                    <input type="text" id="loginUsername" placeholder="ユーザー名">
                    <input type="password" id="loginPassword" placeholder="パスワード">
                    <button onclick="login()">ログイン</button>
                    <div id="loginError" class="error-message" style="display: none;"></div>
                    <div class="register-link">
                        <a href="register.html" class="btn-register-link">新規登録はこちら</a>
                    </div>
                </div>
                <div id="userInfo" class="user-info" style="display: none;">
                    <span>ようこそ、<strong id="usernameDisplay"></strong>さん</span>
                    <button onclick="logout()">ログアウト</button>
                </div>
            </div>
        </header>

        <!-- メインコンテンツ -->
        <main class="main-content">
            <!-- ステップ0: モード選択 -->
            <section id="step0" class="step-section active">
                <h2>診断モードを選択してください</h2>
                <div class="mode-selection-container">
                    <div class="mode-card">
                        <div class="mode-icon">⚡</div>
                        <h3>簡易診断モード</h3>
                        <p class="mode-description">手軽にSPIN質問を生成してトレーニングを開始できます</p>
                        <ul class="mode-features">
                            <li>✓ 手動入力で簡単に開始</li>
                            <li>✓ 企業情報不要</li>
                            <li>✓ すぐにトレーニング開始</li>
                        </ul>
                        <div class="mode-buttons">
                            <button class="mode-select-btn" onclick="selectMode('simple')">このモードを選択</button>
                            <button class="mode-ranking-btn" onclick="showRanking('simple')">🏆 ランキング</button>
                        </div>
                    </div>
                    <div class="mode-card">
                        <div class="mode-icon">🔍</div>
                        <h3>詳細診断モード</h3>
                        <p class="mode-description">企業情報を取得して、より実践的なトレーニングが可能です</p>
                        <ul class="mode-features">
                            <li>✓ 企業情報を自動取得</li>
                            <li>✓ SPIN適合性分析</li>
                            <li>✓ 具体的な質問生成</li>
                        </ul>
                        <div class="mode-buttons">
                            <button class="mode-select-btn" onclick="selectMode('detailed')">このモードを選択</button>
                            <button class="mode-ranking-btn" onclick="showRanking('detailed')">🏆 ランキング</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ステップ1: 提案予定の企業情報（簡易診断モード用） -->
            <section id="step1-simple" class="step-section" style="display: none;">
                <div class="step-header">
                    <h2>提案予定の企業情報</h2>
                    <button onclick="returnToModeSelection()" class="btn-back-to-mode">← モード選択に戻る</button>
                </div>
                <div class="info-box">
                    <p>提案予定の企業情報を入力してください。</p>
                </div>
                <div class="form-group">
                    <label>業界 *</label>
                    <input type="text" id="industry" placeholder="例: IT" value="IT" required>
                </div>
                <div class="form-group">
                    <label>価値提案 *</label>
                    <input type="text" id="value_proposition" placeholder="例: クラウド導入支援サービス" value="クラウド導入支援サービス" required>
                </div>
                <div class="form-group">
                    <label>顧客像（オプション）</label>
                    <input type="text" id="customer_persona" placeholder="例: 中堅IT企業のCTO" value="">
                </div>
                <button onclick="startDiagnosis()" class="btn-primary">診断開始</button>
                <div id="diagnosisStartResult" class="result-box" style="display: none;">
                    <!-- ローディングやエラーメッセージがここに表示される -->
                </div>
            </section>

            <!-- ステップ1: 企業情報取得（詳細診断モード用） -->
            <section id="step1-detailed" class="step-section" style="display: none;">
                <div class="step-header">
                    <h2>提案予定の企業情報</h2>
                    <button onclick="returnToModeSelection()" class="btn-back-to-mode">← モード選択に戻る</button>
                </div>
                <div class="info-box">
                    <p>企業URLから企業情報を取得して、より実践的な診断を行います。</p>
                </div>
                <div class="form-group">
                    <label>企業URL *</label>
                    <input type="url" id="company_url" placeholder="例: https://example.com" required>
                    <small class="form-help">企業の公式サイトや会社概要ページのURLを入力してください</small>
                </div>
                <div class="form-group">
                    <label>価値提案 *</label>
                    <input type="text" id="detailed_value_proposition" placeholder="例: クラウド導入支援サービス" required>
                </div>
                <div class="form-group">
                    <label>顧客像（オプション）</label>
                    <input type="text" id="detailed_customer_persona" placeholder="例: 中堅IT企業のCTO" value="">
                </div>
                <button onclick="fetchCompanyInfo()" class="btn-primary">企業情報を取得</button>
                <div id="companyInfoResult" class="result-box" style="display: none;">
                    <!-- 企業情報がここに表示される -->
                </div>
            </section>

            <!-- ステップ2: セッション開始（非表示 - 直接チャットに遷移するため） -->
            <section id="step2" class="step-section" style="display: none;">
                <!-- このセクションは使用されませんが、互換性のために残しています -->
            </section>

            <!-- ステップ3: チャット（AI顧客との対話） -->
            <section id="step3" class="step-section" style="display: none;">
                <div class="step-header">
                    <h2>ステップ3: AI顧客との対話</h2>
                    <button onclick="returnToModeSelection()" class="btn-back-to-mode">← モード選択に戻る</button>
                </div>
                <div class="chat-container">
                    <!-- 企業概要がここに表示される（詳細診断モード用） -->
                    <div id="companySummary" class="company-summary" style="display: none;"></div>
                    
                    <!-- 商談成功率パネル（詳細診断モード用） -->
                    <div id="successMeter" class="success-meter" style="display: none;">
                        <div class="success-meter-header">
                            <h3>📊 商談成功率</h3>
                        </div>
                        <div class="success-meter-content">
                            <div class="success-probability-display">
                                <span class="success-probability-value" id="successProbabilityValue">50</span>
                                <span class="success-probability-unit">%</span>
                            </div>
                            <div class="success-delta-display" id="successDeltaDisplay" style="display: none;">
                                <span class="success-delta-value" id="successDeltaValue">+0</span>
                                <span class="success-delta-unit">%</span>
                            </div>
                            <div class="success-reason-display" id="successReasonDisplay" style="display: none;">
                                <p class="success-reason-text" id="successReasonText"></p>
                            </div>
                            <div class="success-spin-meta" id="successSpinMeta" style="display: none;">
                                <p class="success-spin-item" id="successSpinStage"></p>
                                <p class="success-spin-item" id="successSpinMessage"></p>
                                <p class="success-spin-item" id="successSpinAppropriateness"></p>
                                <p class="success-spin-item" id="successSpinEvaluation"></p>
                                <p class="success-spin-item" id="successSpinSessionStage"></p>
                            </div>
                            <div class="success-system-notes" id="successSystemNotes" style="display: none;"></div>
                        </div>
                    </div>
                    
                    <div id="closingPhaseIndicator" class="closing-phase-indicator" style="display: none;"></div>
                    <div id="chatMessages" class="chat-messages">
                        <!-- メッセージがここに表示される -->
                    </div>
                    
                    <!-- 温度スコア表示エリア -->
                    <div id="temperatureScorePanel" class="temperature-score-panel" style="display: none;">
                        <div class="temperature-gauge-container">
                            <div class="temperature-gauge-label">顧客温度スコア</div>
                            <div class="temperature-gauge" id="temperatureGauge">
                                <svg viewBox="0 0 120 120" class="gauge-svg">
                                    <circle cx="60" cy="60" r="50" fill="none" stroke="#e0e0e0" stroke-width="10"/>
                                    <circle cx="60" cy="60" r="50" fill="none" stroke="#667eea" stroke-width="10" 
                                            id="gaugeCircle" stroke-dasharray="314" stroke-dashoffset="314" 
                                            transform="rotate(-90 60 60)" stroke-linecap="round"/>
                                    <text x="60" y="65" text-anchor="middle" class="gauge-text" id="gaugeText">0</text>
                                </svg>
                            </div>
                        </div>
                        <div class="temperature-chart-container">
                            <canvas id="temperatureChart" width="400" height="100"></canvas>
                        </div>
                    </div>
                    
                    <div class="chat-input-area">
                        <!-- モード切り替えトグル -->
                        <div class="mode-toggle">
                            <label class="mode-option">
                                <input type="radio" name="chatMode" value="text" checked onchange="switchChatMode('text')">
                                <span>💬 テキスト</span>
                            </label>
                            <label class="mode-option">
                                <input type="radio" name="chatMode" value="realtime" onchange="switchChatMode('realtime')">
                                <span>🎤 リアルタイム会話</span>
                            </label>
                        </div>
                        
                        <!-- テキスト入力エリア（テキストモード時） -->
                        <div id="textInputArea" class="input-mode-area">
                            <input type="text" id="chatMessageInput" placeholder="営業担当者の質問を入力..." onkeypress="handleChatKeyPress(event)">
                            <button onclick="sendChatMessage()" class="btn-primary">送信</button>
                        </div>
                        
                        <!-- リアルタイム会話エリア（リアルタイムモード時） -->
                        <div id="realtimeInputArea" class="input-mode-area" style="display: none;">
                            <button id="realtimeTalkButton" onclick="toggleRealtimeTalk()" class="btn-realtime-talk">
                                <i class="fas fa-phone"></i>
                                <span id="realtimeTalkText">会話を開始</span>
                            </button>
                            <span id="realtimeStatus" class="realtime-status">未接続</span>
                        </div>
                    </div>
                    <div class="chat-actions">
                        <button onclick="finishSession()" class="btn-secondary">セッションを終了してスコアリング</button>
                    </div>
                </div>
            </section>

            <!-- ステップ4: スコアリング結果 -->
            <section id="step4" class="step-section" style="display: none;">
                <div class="step-header">
                    <h2>ステップ4: スコアリング結果</h2>
                    <button onclick="returnToModeSelection()" class="btn-back-to-mode">← モード選択に戻る</button>
                </div>
                <div id="scoringResult" class="scoring-result">
                    <!-- スコアリング結果がここに表示される -->
                </div>
                <div class="action-buttons">
                    <button onclick="viewReport()" class="btn-primary">レポート詳細を見る</button>
                    <button onclick="startNewSession()" class="btn-secondary">新しいセッションを開始</button>
                </div>
            </section>

            <!-- ステップ5: レポート詳細 -->
            <section id="step5" class="step-section" style="display: none;">
                <div class="step-header">
                    <h2>レポート詳細</h2>
                    <button onclick="returnToModeSelection()" class="btn-back-to-mode">← モード選択に戻る</button>
                </div>
                <div id="reportDetails" class="report-details">
                    <!-- レポート詳細がここに表示される -->
                </div>
                <div class="action-buttons">
                    <button onclick="viewSessionList()" class="btn-primary">セッション一覧を見る</button>
                    <button onclick="startNewSession()" class="btn-secondary">新しいセッションを開始</button>
                </div>
            </section>

            <!-- セッション一覧 -->
            <section id="sessionList" class="step-section" style="display: none;">
                <div class="step-header">
                    <h2>セッション一覧</h2>
                    <button onclick="returnToModeSelection()" class="btn-back-to-mode">← モード選択に戻る</button>
                </div>
                <button onclick="refreshSessionList()" class="btn-secondary">更新</button>
                <div id="sessionListContent" class="session-list">
                    <!-- セッション一覧がここに表示される -->
                </div>
            </section>

            <!-- ランキング画面 -->
            <section id="ranking" class="step-section" style="display: none;">
                <div class="step-header">
                    <h2 id="rankingTitle">ランキング</h2>
                    <button onclick="returnToModeSelection()" class="btn-back-to-mode">← モード選択に戻る</button>
                </div>
                <div id="rankingContent" class="ranking-content">
                    <div class="ranking-loading" id="rankingLoading">
                        <p>ランキングを読み込み中...</p>
                    </div>
                    <div class="ranking-table-container" id="rankingTable" style="display: none;">
                        <!-- ランキングテーブルがここに表示される -->
                    </div>
                    <div class="ranking-empty" id="rankingEmpty" style="display: none;">
                        <p>まだランキングデータがありません。</p>
                        <p>診断を完了するとランキングに表示されます。</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- ログビューアー -->
    <div id="logViewer" class="log-viewer" style="display: none;">
        <div class="log-viewer-header">
            <h2>📋 ログビューアー</h2>
            <div class="log-viewer-actions">
                <button onclick="window.logViewer.exportLogs()" class="btn-secondary">エクスポート</button>
                <button onclick="window.logViewer.clearLogs()" class="btn-secondary">クリア</button>
                <button onclick="window.logViewer.close()" class="btn-secondary">閉じる</button>
            </div>
        </div>
        <div class="log-viewer-filters">
            <label>
                <input type="checkbox" id="filterInfo" checked onchange="window.logViewer.updateLogs()"> Info
            </label>
            <label>
                <input type="checkbox" id="filterWarning" checked onchange="window.logViewer.updateLogs()"> Warning
            </label>
            <label>
                <input type="checkbox" id="filterError" checked onchange="window.logViewer.updateLogs()"> Error
            </label>
            <label>
                <input type="checkbox" id="filterDebug" checked onchange="window.logViewer.updateLogs()"> Debug
            </label>
        </div>
        <div id="logViewerContent" class="log-viewer-content"></div>
    </div>

    <!-- ログビューアー開閉ボタン -->
    <button id="logViewerToggle" class="log-viewer-toggle" onclick="window.logViewer.toggle()" title="ログビューアー">
        📋
    </button>

    <script src="logger.js"></script>
    <script src="log-viewer.js"></script>
    <script src="realtime-client.js"></script>
    <script src="app.js"></script>
    <script src="app-realtime.js"></script>
    
    <!-- Footer -->
    <footer class="footer" style="margin-top: 40px; padding: 20px; text-align: center; border-top: 1px solid #e0e0e0;">
        <p>&copy; 2025 SalesMind. All rights reserved.</p>
        <p>AI営業思考トレーナー - SPINメソッドで商談スキルを向上</p>
    </footer>
</body>
</html>

